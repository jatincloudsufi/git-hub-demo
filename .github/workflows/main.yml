name:Push docker image to GCR
on:
   push:
      branches:
        -main


jobs:
  build-and-push:
    runs-on:ubuntu:latest
    steps:
    -name
     uses:actions/checkout@v2


    -name: Log into GCP
      uses:GoogleCloudPlatform/github-actions/setup-gcloud@master
      with:
        version:'latest'
        project_id:cs-tmpl-test
        service_account_email:workload-identity-cloudsufi@cs-tmpl-test.iam.gserviceaccount.com
        service_account_key:${{ secrets.GCP_SA_KEY }}

    -name: Build docker image
      run:
        docker build -t gcr.io/cs-tmpl-test/Dockerfile:${{github.sha}}  
    
    name:push docker image to gcr
     run:
     docker push gcr.io/cs-tmpl-test/Dockerfile:${{github.sha}}
